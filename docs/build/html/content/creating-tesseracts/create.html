<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Creating Tesseracts" />
<meta property="og:type" content="website" />
<meta property="og:url" content="content/creating-tesseracts/create.html" />
<meta property="og:site_name" content="Tesseract" />
<meta property="og:description" content="In this page you will find instructions on how to create your own tesseracts, starting from a very basic example and then building on top of it with some advanced patterns. All this requires some b..." />
<meta name="description" content="In this page you will find instructions on how to create your own tesseracts, starting from a very basic example and then building on top of it with some advanced patterns. All this requires some b..." />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Tips for defining Tesseract APIs" href="advanced.html" /><link rel="prev" title="Differentiable Programming basics" href="../introduction/differentiable-programming.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Creating Tesseracts - Tesseract 0.9.1.dev18+gc1fb613 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=3560ba21" />




<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;

  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;

    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;

      }
    }
  }
</style></head>
  <body>

    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">Tesseract 0.9.1.dev18+gc1fb613 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">

      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">

  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../../_static/logo-light.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../../_static/logo-dark.png" alt="Dark Logo"/>
  </div>


</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/get-started.html">Get started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction/differentiable-programming.html">Differentiable Programming basics</a></li>
<li class="toctree-l1"><a class="reference external" href="https://si-tesseract.discourse.group/">Tesseract User Forums</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Creating Tesseracts</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Creating Tesseracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Tips for defining Tesseract APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deploying Tesseracts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Using Tesseracts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using-tesseracts/use.html">Interacting with Tesseracts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-tesseracts/array-encodings.html">Array encodings</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using-tesseracts/advanced.html">Advanced usage</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://si-tesseract.discourse.group/c/showcase/expert-showcase/12">Expert showcase</a></li>
<li class="toctree-l1"><a class="reference external" href="https://si-tesseract.discourse.group/c/support/how-to-guides/10">How-to Guides</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../examples/example_gallery.html">Example Gallery</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Example Gallery</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/arm64.html">Custom build steps: PyVista on ARM64 example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/localdependency.html">Installing local dependencies into a Tesseract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/packagedata.html">Passing in local data into a Tesseract</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/helloworld.html">Hello World</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/dataloader.html">Dataloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/meshstats.html">Mes Stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/vectoradd.html">Vector Add</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/bootcamp.html">Tesseract Bootcamp</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/faq.html">Frequently Asked Questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/config.html">Configuration via <code class="docutils literal notranslate"><span class="pre">tesseract_config.yaml</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/endpoints.html">Tesseract endpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tesseract-cli.html"><code class="docutils literal notranslate"><span class="pre">tesseract</span></code> command line application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tesseract-api.html"><code class="docutils literal notranslate"><span class="pre">tesseract</span></code> Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tesseract-runtime-cli.html"><code class="docutils literal notranslate"><span class="pre">tesseract-runtime</span></code> command line application</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/tesseract-runtime-api.html"><code class="docutils literal notranslate"><span class="pre">tesseract_runtime</span></code> Python API</a></li>
</ul>

</div>
</div>

      </div>

    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/content/creating-tesseracts/create.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="creating-tesseracts">
<h1>Creating Tesseracts<a class="headerlink" href="#creating-tesseracts" title="Link to this heading">¶</a></h1>
<p>In this page you will find instructions on how to create your own
tesseracts, starting from a very basic example and then building on
top of it with some advanced patterns. All this requires some basic
knowledge of tesseracts, so we suggest you to read at least the
<a class="reference internal" href="../introduction/get-started.html#tr-quickstart"><span class="std std-ref">Quickstart page</span></a> beforehand.</p>
<section id="initialize-a-new-tesseract">
<h2>Initialize a new Tesseract<a class="headerlink" href="#initialize-a-new-tesseract" title="Link to this heading">¶</a></h2>
<p>In order to start creating a Tesseract in your current directory,
you can run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>tesseract<span class="w"> </span>init
</pre></div>
</div>
<p>and follow the prompt to specify a name for your tesseract.
(Alternatively, you can use the option <code class="docutils literal notranslate"><span class="pre">--name</span></code> to provide this inline.)
This will create three files in the current directory:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tesseract_api.py</span></code>, a python module where you should implement
the core computations in the Tesseract.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tesseract_config.yaml</span></code>, a <code class="docutils literal notranslate"><span class="pre">yaml</span></code> file where you can specify metadata, such as Tesseract name and version, various build options, such as
which base Docker image to use, define custom steps in building the Tesseract, access to external data, and so on.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tesseract_requirements.txt</span></code>, a text file where you can specify the (Python)
dependencies of your Tesseract. It should be in the
<a class="reference external" href="https://pip.pypa.io/en/stable/reference/requirements-file-format/">requirements file format</a>.</p></li>
</ul>
<p>If you want to create these files in some other path, you can use the <code class="docutils literal notranslate"><span class="pre">--target-dir</span> <span class="pre">[DIRECTORY]</span></code>
option.
Other options include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--recipe</span></code> allows you to use ready-made templates that generate pre-configured Tesseract configurations for common scenarios (such as generating autodiff endpoints from JAX functions).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--help</span></code> will print help regarding CLI usage and list all currently available recipes.</p></li>
</ul>
</section>
<section id="define-a-simple-tesseract">
<h2>Define a simple Tesseract<a class="headerlink" href="#define-a-simple-tesseract" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">tesseract_api.py</span></code> produced by <code class="docutils literal notranslate"><span class="pre">tesseract</span> <span class="pre">init</span></code> contains some boilerplate code
which can guide you. Let’s follow it section by section and pretend we want to implement
a very simple <code class="docutils literal notranslate"><span class="pre">helloworld</span></code> Tesseract: one that accepts a string <code class="docutils literal notranslate"><span class="pre">name</span></code> and returns <code class="docutils literal notranslate"><span class="pre">&quot;Hello</span> <span class="pre">{name}!&quot;</span></code>.</p>
<p>The first section in <code class="docutils literal notranslate"><span class="pre">tesseract_api.py</span></code> looks like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">InputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="k">class</span><span class="w"> </span><span class="nc">OutputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>This is where you can define the input and output schemas of the Tesseract<a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> via
<a class="reference external" href="https://docs.pydantic.dev/latest/">pydantic</a>. As we want <code class="docutils literal notranslate"><span class="pre">helloworld</span></code> to accept a string
and return one, we can edit this section as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">InputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Name of the person you want to greet.&quot;</span>
    <span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OutputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">greeting</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;A greeting!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Providing field descriptions is not mandatory, but if you do,
they will be included in live docs and in the generated schemas
themselves. This is useful to end users, so in general we recommend to
write them. You can also set default values, validators (both for each field individually
and at the model level), and so on. Have a look at
<a class="reference external" href="https://docs.pydantic.dev/latest/">pydantic’s docs</a> to know more.</p>
<p>Just below the schemas you will find the section where required
endpoints are defined:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">InputSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OutputSchema</span><span class="p">:</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>These must always be present, with no exception, for every Tesseract. Right now,
only <code class="docutils literal notranslate"><span class="pre">apply</span></code> is required.</p>
<p>In the <code class="docutils literal notranslate"><span class="pre">apply</span></code> function instead we define the calculation we want our Tesseract
to implement. In <code class="docutils literal notranslate"><span class="pre">helloworld</span></code>’s case, this is simply:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">apply</span><span class="p">(</span><span class="n">inputs</span><span class="p">:</span> <span class="n">InputSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OutputSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Greet a person whose name is given as input.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">OutputSchema</span><span class="p">(</span><span class="n">greeting</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Hello </span><span class="si">{</span><span class="n">inputs</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The docstring of <code class="docutils literal notranslate"><span class="pre">apply</span></code> (as well as all others that you implement in
<code class="docutils literal notranslate"><span class="pre">tesseract_api.py</span></code>) will be available to your Tesseract’s users.</p>
</div>
<p>The last section in <code class="docutils literal notranslate"><span class="pre">tesseract_api.py</span></code> contains templates for optional endpoints:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># def jacobian(inputs: InputSchema, jac_inputs: set[str], jac_outputs: set[str]):</span>
<span class="c1">#     return {}</span>

<span class="o">...</span>
</pre></div>
</div>
<p>You can leave it untouched for this example, as the operation we are
implementing is not differentiable.</p>
<p>Finally, we can set the name of this Tesseract and its version in
<code class="docutils literal notranslate"><span class="pre">tesseract_config.yaml</span></code>.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;helloworld&quot;</span>
<span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0.0&quot;</span>
<span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;A</span><span class="nv"> </span><span class="s">sample</span><span class="nv"> </span><span class="s">Python</span><span class="nv"> </span><span class="s">app&quot;</span>
</pre></div>
</div>
<p>If you followed all these steps, congratulations! 🎉 You are ready to
build your first Tesseract.</p>
</section>
<section id="build-a-tesseract">
<h2>Build a Tesseract<a class="headerlink" href="#build-a-tesseract" title="Link to this heading">¶</a></h2>
<p>In order to build a Tesseract, you can use the <code class="docutils literal notranslate"><span class="pre">tesseract</span> <span class="pre">build</span></code> command.
For the <code class="docutils literal notranslate"><span class="pre">helloworld</span></code> Tesseract we defined above, assuming that our
current directory is where <code class="docutils literal notranslate"><span class="pre">tesseract_api.py</span></code> is located,
the full command would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tesseract build . -t v1.0.0
</pre></div>
</div>
<p>This is to be interpreted as “build the Tesseract which is located in
the current directory, and tag it as <code class="docutils literal notranslate"><span class="pre">v1.0.0</span></code>”. The name of the Tesseract
is defined in the <code class="docutils literal notranslate"><span class="pre">tesseract_config.yaml</span></code> file, and it is <code class="docutils literal notranslate"><span class="pre">helloworld</span></code>, so the full
name of the tesseract we just built is <code class="docutils literal notranslate"><span class="pre">helloworld:v1.0.0</span></code>.</p>
<p>It is not mandatory to provide a tag for a Tesseract; in case you don’t do it, it is tagged
as <code class="docutils literal notranslate"><span class="pre">latest</span></code>, and the Tesseract that was previously tagged as <code class="docutils literal notranslate"><span class="pre">latest</span></code> loses that tag.</p>
<section id="viewing-built-tesseracts">
<h3>Viewing Built Tesseracts<a class="headerlink" href="#viewing-built-tesseracts" title="Link to this heading">¶</a></h3>
<p>In order to view all locally available Tesseracts, you can run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>tesseract<span class="w"> </span>list
</pre></div>
</div>
<p>The output will be a table of Tesseracts images with their ID, name, version, and description:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span class="w"> </span>ID<span class="w">                  </span>┃<span class="w"> </span>Tags<span class="w">                  </span>┃<span class="w"> </span>Name<span class="w">       </span>┃<span class="w"> </span>Version<span class="w"> </span>┃<span class="w"> </span>Description<span class="w">                               </span>┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│<span class="w"> </span>sha256:d4bdc2c29eb1<span class="w"> </span>│<span class="w"> </span><span class="o">[</span><span class="s1">&#39;helloworld:latest&#39;</span><span class="o">]</span><span class="w"> </span>│<span class="w"> </span>helloworld<span class="w"> </span>│<span class="w"> </span><span class="m">1</span>.0.0<span class="w">   </span>│<span class="w"> </span>A<span class="w"> </span>sample<span class="w"> </span>Python<span class="w"> </span>app<span class="w">                       </span>│
└─────────────────────┴───────────────────────┴────────────┴─────────┴───────────────────────────────────────────┘
</pre></div>
</div>
</section>
</section>
<section id="arrays-in-the-schema">
<h2>Arrays in the schema<a class="headerlink" href="#arrays-in-the-schema" title="Link to this heading">¶</a></h2>
<p>In scientific computing, one of the most important data
structures are N-dimensional arrays. For these, you should use
the <code class="docutils literal notranslate"><span class="pre">tesseract_core.runtime.Array</span></code> type annotation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tesseract_core.runtime</span><span class="w"> </span><span class="kn">import</span> <span class="n">Array</span><span class="p">,</span> <span class="n">Float32</span>

<span class="k">class</span><span class="w"> </span><span class="nc">InputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Array</span><span class="p">[(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">Float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A 3D vector&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">Array</span><span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">Float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A 3x3 matrix&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">Float64</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;A scalar&quot;</span><span class="p">)</span>
    <span class="n">v</span><span class="p">:</span> <span class="n">Array</span><span class="p">[(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">Float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A vector of unknown length&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">p</span><span class="p">:</span> <span class="n">Array</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;An array of any shape&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>The first parameter of <code class="docutils literal notranslate"><span class="pre">Array</span></code> is the <code class="docutils literal notranslate"><span class="pre">shape</span></code>, while the second is the <code class="docutils literal notranslate"><span class="pre">dtype</span></code>, for both of them you can use the same convention as numpy’s <code class="docutils literal notranslate"><span class="pre">ndarray</span></code>.
Within a Tesseract, the variables marked as <code class="docutils literal notranslate"><span class="pre">Array</span></code> will be cast to <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> objects of the given <code class="docutils literal notranslate"><span class="pre">dtype</span></code> and <code class="docutils literal notranslate"><span class="pre">shape</span></code>, so you can rely
on numpy’s broadcasting rules and operators. In this example, <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">&#64;</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">s</span></code> would be a valid expression to use in <code class="docutils literal notranslate"><span class="pre">apply</span></code> and similar endpoints, which
corresponds to multiplying the <code class="docutils literal notranslate"><span class="pre">r</span></code> matrix with the <code class="docutils literal notranslate"><span class="pre">x</span></code> vector, and then adding the scalar <code class="docutils literal notranslate"><span class="pre">s</span></code> (broadcasted to match the vector’s dimension) to that.</p>
<p>For scalar values you can use <code class="docutils literal notranslate"><span class="pre">tesseract_core.runtime.Float32</span></code>, <code class="docutils literal notranslate"><span class="pre">tesseract_core.runtime.Float64</span></code>, <code class="docutils literal notranslate"><span class="pre">tesseract_core.runtime.Int32</span></code>,
and so on (see <a class="reference internal" href="../api/tesseract-runtime-api.html"><span class="std std-doc">tesseract_core.runtime API documentation</span></a> for a comprehensive list).
You could use just <code class="docutils literal notranslate"><span class="pre">float</span></code>, but you would not be able to make use of the autodiff features which
we show in <a class="reference internal" href="#tr-create-diff"><span class="std std-ref">the Differentiability section</span></a>.</p>
</section>
<section id="nested-schemas">
<h2>Nested schemas<a class="headerlink" href="#nested-schemas" title="Link to this heading">¶</a></h2>
<p>As both <code class="docutils literal notranslate"><span class="pre">InputSchema</span></code> and <code class="docutils literal notranslate"><span class="pre">OutputSchema</span></code> are pydantic <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>s,
they support nesting other <code class="docutils literal notranslate"><span class="pre">BaseModel</span></code>s within them. This can be useful
to create data structures that are convenient to work with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Mesh</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple mesh schema.&quot;&quot;&quot;</span>
    <span class="n">points</span><span class="p">:</span> <span class="n">Array</span><span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">Float32</span><span class="p">]</span>
    <span class="n">num_points_per_cell</span><span class="p">:</span> <span class="n">Array</span><span class="p">[(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">Float32</span><span class="p">]</span>
    <span class="n">cell_connectivity</span><span class="p">:</span> <span class="n">Array</span><span class="p">[(</span><span class="kc">None</span><span class="p">,),</span> <span class="n">Int32</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">InputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">wing_shape</span><span class="p">:</span> <span class="n">Mesh</span>
    <span class="n">propeller_shape</span><span class="p">:</span> <span class="n">Mesh</span>
</pre></div>
</div>
</section>
<section id="differentiability">
<span id="tr-create-diff"></span><h2>Differentiability<a class="headerlink" href="#differentiability" title="Link to this heading">¶</a></h2>
<p>A key feature of Tesseracts is their ability to expose endpoints for calculating various kinds of derivatives when the operation they implement is differentiable, which in turn makes it possible to combine multiple Tesseracts into automatically differentiable workflows! This is advantageous in multiple contexts: shape optimization, model calibration, and so on.</p>
<p>Keeping with one of Tesseract’s key foci being <em>validation</em>, the type annotation <a class="reference internal" href="../api/tesseract-runtime-api.html#tesseract_core.runtime.Differentiable" title="tesseract_core.runtime.Differentiable"><code class="xref py py-class docutils literal notranslate"><span class="pre">tesseract_core.runtime.Differentiable</span></code></a> is introduced to mark outputs that can be differentiated, and inputs that can be differentiated with respect to.
All outputs marked as <code class="docutils literal notranslate"><span class="pre">Differentiable</span></code> will be considered differentiable with respect to
all inputs marked as <code class="docutils literal notranslate"><span class="pre">Differentiable</span></code>.
Attempting to differentiate (with respect to) an output/input (e.g. by passing <code class="docutils literal notranslate"><span class="pre">jac_inputs=[&quot;non_differentiable_arg&quot;]</span></code> to the <code class="docutils literal notranslate"><span class="pre">jacobian</span></code> endpoint) will raise a validation error even before the endpoint is invoked.</p>
<p>For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tesseract_core.runtime</span><span class="w"> </span><span class="kn">import</span> <span class="n">Differentiable</span><span class="p">,</span> <span class="n">Float64</span>


<span class="k">class</span><span class="w"> </span><span class="nc">InputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">Differentiable</span><span class="p">[</span><span class="n">Float64</span><span class="p">]</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">Differentiable</span><span class="p">[</span><span class="n">Array</span><span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">Float32</span><span class="p">]]</span>
    <span class="n">s</span><span class="p">:</span> <span class="nb">float</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OutputSchema</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">a</span><span class="p">:</span> <span class="n">Differentiable</span><span class="p">[</span><span class="n">Float64</span><span class="p">]</span>
    <span class="n">b</span><span class="p">:</span> <span class="nb">int</span>
</pre></div>
</div>
<p>Here, it will be possible in principle to differentiate <code class="docutils literal notranslate"><span class="pre">a</span></code> in the Tesseract’s output with respect to the scalar
parameter <code class="docutils literal notranslate"><span class="pre">x</span></code> and with respect to each of the components of the matrix <code class="docutils literal notranslate"><span class="pre">r</span></code> – but not with respect to <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><code class="docutils literal notranslate"><span class="pre">Differentiable</span></code> can only be used on <a class="reference internal" href="../api/tesseract-runtime-api.html#tesseract_core.runtime.Array" title="tesseract_core.runtime.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">tesseract_core.runtime.Array</span></code></a> types, which includes aliases for
rank 0 tensors like <a class="reference internal" href="../api/tesseract-runtime-api.html#tesseract_core.runtime.Float64" title="tesseract_core.runtime.Float64"><code class="xref py py-class docutils literal notranslate"><span class="pre">Float64</span></code></a>. Do not use it on
Python base types – things like <code class="docutils literal notranslate"><span class="pre">Differentiable[float]</span></code> will trigger errors.</p>
</div>
<p>Aside from marking the parameters with respect to which your Tesseract is differentiable, one also
must implement the logic for how the derivatives shall be calculated. If you are using an autodiff
framework like <code class="docutils literal notranslate"><span class="pre">jax</span></code> or <code class="docutils literal notranslate"><span class="pre">pytorch</span></code>, these implementations will mostly be one-liners, but you are free
in general to implement whatever method works best for you.
Check the <a class="reference internal" href="../introduction/differentiable-programming.html#tr-autodiff"><span class="std std-ref">page on Autodiff</span></a> for more details on how to implement the differential
endpoints like <code class="docutils literal notranslate"><span class="pre">jacobian</span></code>, <code class="docutils literal notranslate"><span class="pre">jacobian_vector_product</span></code>, and so on.</p>
</section>
</section>
<hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>We often refer to “a Tesseract’s input schema” to indicate the input of the Tesseract’s
<code class="docutils literal notranslate"><span class="pre">apply</span></code> function. This should not lead to confusion, as there is only one core
functionality in a Tesseract, the one implemented in <code class="docutils literal notranslate"><span class="pre">apply</span></code>. All the other
functions in a Tesseract (<code class="docutils literal notranslate"><span class="pre">jacobian</span></code>, <code class="docutils literal notranslate"><span class="pre">jacobian_vector_product</span></code>, …) are just derivatives of <code class="docutils literal notranslate"><span class="pre">apply</span></code>, and their schemas are adapted automatically
from the schema of <code class="docutils literal notranslate"><span class="pre">apply</span></code>.</p>
</aside>
</aside>

        </article>
      </div>
      <footer>

        <div class="related-pages">
          <a class="next-page" href="advanced.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Tips for defining Tesseract APIs</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../introduction/differentiable-programming.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>

                <div class="title">Differentiable Programming basics</div>

              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Pasteur Labs
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s

            <a href="https://github.com/pradyunsg/furo">Furo</a>

          </div>
          <div class="right-details">

          </div>
        </div>

      </footer>
    </div>
    <aside class="toc-drawer">


      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Creating Tesseracts</a><ul>
<li><a class="reference internal" href="#initialize-a-new-tesseract">Initialize a new Tesseract</a></li>
<li><a class="reference internal" href="#define-a-simple-tesseract">Define a simple Tesseract</a></li>
<li><a class="reference internal" href="#build-a-tesseract">Build a Tesseract</a><ul>
<li><a class="reference internal" href="#viewing-built-tesseracts">Viewing Built Tesseracts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#arrays-in-the-schema">Arrays in the schema</a></li>
<li><a class="reference internal" href="#nested-schemas">Nested schemas</a></li>
<li><a class="reference internal" href="#differentiability">Differentiability</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>


    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=7ef312bd"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>
