# Copyright 2025 Pasteur Labs. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0

# Tesseract API module for {{name}}
# Generated by tesseract {{version}} on {{timestamp}}


from pydantic import BaseModel
{% if extra_imports is defined and extra_imports %}

{{extra_imports}}
{% endif %}

#
# Schemas
#


class InputSchema(BaseModel):
{% if input_schema_fields is defined and input_schema_fields %}
{{input_schema_fields}}
{% else %}
    pass
{% endif %}


class OutputSchema(BaseModel):
{% if output_schema_fields is defined and output_schema_fields %}
{{output_schema_fields}}
{% else %}
    pass
{% endif %}


#
# Required endpoints
#


def apply(inputs: InputSchema) -> OutputSchema:
{% if apply_body is defined and apply_body %}
{{apply_body}}
{% else %}
    return OutputSchema()
{% endif %}


#
# Optional endpoints
#

# import numpy as np

# def jacobian(inputs: InputSchema, jac_inputs: set[str], jac_outputs: set[str]):
#     return {}

# def jacobian_vector_product(
#     inputs: InputSchema,
#     jvp_inputs: set[str],
#     jvp_outputs: set[str],
#     tangent_vector: dict[str, np.typing.ArrayLike]
# ) -> dict[str, np.typing.ArrayLike]:
#     return {}

# def vector_jacobian_product(
#     inputs: InputSchema,
#     vjp_inputs: set[str],
#     vjp_outputs: set[str],
#     cotangent_vector: dict[str, np.typing.ArrayLike]
# ) -> dict[str, np.typing.ArrayLike]:
#     return {}

# def abstract_eval(abstract_inputs):
#     return {}
